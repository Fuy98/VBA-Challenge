Sub Ticket_table()

  For Each ws In Worksheets
    Dim WorksheetName As String

    ' Determine the Last Row of each worksheet.
    LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row

    'Attribute
    WorksheetName = ws.Name
    
     ' Set an initial variable for holding the brand name
    Dim Ticket_symbol As String

    'Set an initial variable for holding the Total Stock Volume'
    Dim Total_SV As Double
    Total_SV = 0

    ' Keep track of the location for each Ticket symbol in the table
    Dim Summary_Table_Row As Integer
    Summary_Table_Row = 2

    'Set the Table'
    ws.Cells(1, 9).Value = "Ticket"  'I'
    ws.Cells(1, 10).Value = "Yearly Change"  'J'
    ws.Cells(1, 11).Value = "Percent Change"  'K'
    ws.Cells(1, 12).Value = "Total Stock Volume"  'L'
    
     ' Loop through all the table'
    For i = 2 To LastRow

        ' Check if we are still within the Ticket symbol, if it is not...
        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

            ' Set the Ticket symbol
            Ticket_symbol = Cells(i, 1).Value

            ' Add to the Brand Total
            Total_SV = Total_SV + Cells(i, 7).Value

            ' Print the Ticket symbol in the Table
            Range("I" & Summary_Table_Row).Value = Ticket_symbol

            ' Print the Brand Amount to the Summary Table
            Range("L" & Summary_Table_Row).Value = Total_SV

            ' Add one to the table row
            Summary_Table_Row = Summary_Table_Row + 1

            ' Reset the Brand Total
            Total_SV = 0

            'If the cell immediately following a row is the same Ticket symbol...
    
            Else
    
                Total_SV = Total_SV + Cells(i, 7).Value

        End If

  Next i



    
  Next ws
  MsgBox ("Fixes Complete")
End Sub

